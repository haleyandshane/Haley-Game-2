<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>Baby Steps — Home Upgrade v3.1</title>
  <meta name="theme-color" content="#87C5FF">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192.svg">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <style>
    :root{
      --bg:#f7fbff; --ink:#0b1220; --muted:#5b687a; --card:#ffffff;
      --primary:#0f62fe; --accent:#87C5FF; --ok:#10b981; --warn:#f59e0b; --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
    .wrap{max-width:560px;margin:0 auto;padding:18px 16px 70px;display:flex;flex-direction:column;gap:14px}
    header{display:flex;align-items:center;gap:10px}
    header img{width:36px;height:36px}
    h1{font-size:20px;margin:0}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .card{background:var(--card);border:1px solid #e6eef7;border-radius:14px;padding:14px;
      box-shadow:0 6px 20px rgba(0,0,0,.04)}
    .big{font-weight:800;font-size:32px}
    .pill{border:1px solid #d7e6fb;border-radius:999px;padding:6px 10px;color:var(--muted);font-size:12px}
    button{appearance:none;border:none;border-radius:12px;padding:14px 16px;background:var(--primary);
      color:white;font-weight:700;font-size:16px;box-shadow:0 10px 18px rgba(15,98,254,.25);
      -webkit-tap-highlight-color:transparent}
    button:active{transform:translateY(1px)}
    .secondary{background:white;color:var(--ink);border:1px solid #d7e6fb;box-shadow:none}
    .ghost{background:white;color:var(--ink);border:1px dashed #d7e6fb;box-shadow:none}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .tiny{font-size:12px;color:var(--muted)}
    .garden{height:200px;background:linear-gradient(#d1f3ff,#f7fbff);border:1px dashed #cde3fb;border-radius:14px;display:grid;place-items:center;margin-top:8px}
    .garden-scene{display:flex;gap:18px;align-items:end;flex-wrap:wrap;justify-content:center}
    .plot{width:80px;height:80px;border:2px solid #9ad18b;border-radius:10px;background:#eaffea;display:grid;place-items:center;font-size:32px}
    dialog{border:none;border-radius:14px;max-width:540px;width:92vw;padding:0;box-shadow:0 20px 60px rgba(0,0,0,.2)}
    dialog .inner{padding:16px}
    dialog::backdrop{background:rgba(0,0,0,.3)}
    .odd-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:10px}
    .tile{height:64px;border-radius:10px;border:1px solid #d7e6fb}
    .install-tip{display:none;background:#fffdef;border:1px solid #ffe58f;color:#8b6d00;padding:10px;border-radius:10px}
    .section-title{display:flex;align-items:center;justify-content:space-between}
    /* Match-3 */
    .m3-grid{display:grid;grid-template-columns:repeat(5,56px);gap:6px;justify-content:center;margin:10px 0}
    .m3-cell{width:56px;height:56px;border-radius:12px;border:1px solid #d7e6fb;display:grid;place-items:center;font-size:28px;background:#fff}
    .m3-selected{outline:3px solid var(--accent)}
    /* Sudoku */
    .sdk-grid{display:grid;grid-template-columns:repeat(9,1fr);gap:0;border:2px solid #cbd5e1;border-radius:10px;overflow:hidden;margin-top:10px}
    .sdk-cell{width:calc((100% - 0px)/9); aspect-ratio:1/1; border:1px solid #e5e7eb; display:grid; place-items:center; font-size:18px}
    .sdk-cell.given{background:#f3f7ff;font-weight:700}
    .sdk-cell.sel{outline:2px solid var(--accent); z-index:1; position:relative}
    .sdk-rowSep{border-bottom:2px solid #cbd5e1}
    .sdk-colSep{border-right:2px solid #cbd5e1}
    .sdk-keypad{display:grid;grid-template-columns:repeat(9,1fr);gap:6px;margin-top:10px}
    .sdk-keypad button{padding:12px}
    .sdk-bad{color:var(--danger)}
    /* Chore form */
    .field{display:flex;gap:8px;align-items:center;margin-top:8px}
    .field input{flex:1;padding:12px;border:1px solid #d7e6fb;border-radius:10px}
    .field .num{width:130px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="icons/icon-192.svg" alt="icon">
      <div>
        <h1>Baby Steps — Home Upgrade</h1>
        <div class="tiny">Chores build your engine. Games convert it into bursts.</div>
      </div>
    </header>

    <div class="card">
      <div class="row" style="justify-content:space-between">
        <div class="row">
          <div>
            <div class="tiny">Coins</div>
            <div id="coins" class="big">0</div>
          </div>
          <div class="pill">Rate: <span id="rateSec">1</span>/sec · <span id="rateMin">60</span>/min</div>
          <div class="pill">Permanent Boost: <span id="permBoost">0</span>/sec</div>
        </div>
        <button id="openGames" class="secondary">Play a mini-game</button>
      </div>
      <div class="garden">
        <div id="garden" class="garden-scene"></div>
      </div>
      <div id="upgradesGrid" class="grid" style="margin-top:10px"></div>
      <div id="installTip" class="install-tip" style="margin-top:10px">Tip: Add to Home Screen for full-screen app experience.</div>
    </div>

    <div class="card">
      <div class="section-title">
        <div><strong>Chores → permanent rate</strong> <span class="tiny">(each completion adds its own +/sec)</span></div>
        <button class="secondary" id="addChoreBtn">Add chore</button>
      </div>
      <div id="choreList" class="row" style="flex-direction:column;align-items:stretch;gap:8px;margin-top:8px"></div>
    </div>

    <div class="tiny">Private & offline. Data stays on this device.</div>
  </div>

  <!-- Dialogs -->
  <dialog id="choreDialog">
    <div class="inner">
      <h3>Add a chore</h3>
      <div class="field">
        <input id="choreInput" placeholder="e.g., Empty dishwasher">
        <input id="choreValue" class="num" type="number" step="0.01" min="0" value="0.10" placeholder="+/sec">
      </div>
      <div class="tiny">Tip: 0.10/sec ≈ +6/min. Bigger chores → higher numbers.</div>
      <div class="row" style="margin-top:10px;justify-content:flex-end">
        <button class="secondary" id="cancelChore">Cancel</button>
        <button id="saveChore">Save</button>
      </div>
    </div>
  </dialog>

  <dialog id="gamesDialog">
    <div class="inner">
      <h3>Mini-games</h3>
      <div class="tiny">Rewards scale with your current rate per second.</div>
      <div class="grid" style="margin-top:10px">
        <button id="gameOdd" class="secondary">Odd Tile (+10× rate)</button>
        <button id="gameM3" class="secondary">Match-3 Lite (60s · score×rate)</button>
        <button id="gameSdk">Sudoku 9×9 (+100× rate on solve)</button>
      </div>
      <div class="row" style="justify-content:flex-end;margin-top:10px">
        <button id="closeGames" class="secondary">Close</button>
      </div>
    </div>
  </dialog>

  <dialog id="puzzleDialog">
    <div class="inner">
      <h3>Find the odd tile</h3>
      <div class="tiny">Tap the one that looks slightly different.</div>
      <div id="puzzleGrid" class="odd-grid"></div>
    </div>
  </dialog>

  <dialog id="m3Dialog">
    <div class="inner">
      <h3>Match-3 Lite — 60 seconds</h3>
      <div class="tiny">Swap adjacent tiles to make 3+ in a row/column.</div>
      <div id="m3Grid" class="m3-grid"></div>
      <div class="row" style="justify-content:space-between">
        <div>Score: <strong id="m3Score">0</strong></div>
        <div class="tiny">Time left: <span id="m3Timer">60</span>s</div>
      </div>
      <div class="row" style="justify-content:flex-end;margin-top:10px">
        <button id="closeM3" class="secondary">Close</button>
      </div>
    </div>
  </dialog>

  <dialog id="sdkDialog">
    <div class="inner">
      <h3>Sudoku 9×9</h3>
      <div class="tiny">Fill 1–9 so each row, column, and 3×3 box has all digits.</div>
      <div id="sdkGrid" class="sdk-grid"></div>
      <div class="sdk-keypad">
        <button data-n="1">1</button><button data-n="2">2</button><button data-n="3">3</button>
        <button data-n="4">4</button><button data-n="5">5</button><button data-n="6">6</button>
        <button data-n="7">7</button><button data-n="8">8</button><button data-n="9">9</button>
      </div>
      <div class="row" style="justify-content:space-between;margin-top:10px">
        <button id="sdkCheck" class="secondary">Check</button>
        <div class="tiny">Solved? Reward = <strong>100×</strong> current rate</div>
      </div>
      <div class="row" style="justify-content:flex-end;margin-top:10px">
        <button id="sdkNew" class="ghost">New puzzle</button>
        <button id="sdkClose" class="secondary">Close</button>
      </div>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
